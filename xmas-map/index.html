<html>
	<head>
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
		<link rel="stylesheet" type="text/css" href="http://cdn.leafletjs.com/leaflet-0.7.3/leaflet.css">
		<script type="text/javascript" src="http://cdn.leafletjs.com/leaflet-0.7.3/leaflet.js"></script>
		<!--script type="text/javascript" src="http://code.jquery.com/jquery-1.11.0.js"></script>
		<script type="text/javascript" src="http://code.jquery.com/mobile/1.4.4/jquery.mobile-1.4.4.min.js"></script>
		<link rel="stylesheet" type="text/css" href="http://code.jquery.com/mobile/1.4.4/jquery.mobile-1.4.4.min.css"-->
		<style>
			body {
				padding: 0;
				margin: 0;
			}
			html, body, #map {
				height: 100%
				position:absolute;
			    top:0;
			    bottom:0;
			    left:0;
			    right:0;
			    margin: 0;
			    padding: 0;;
			}
		</style>
	</head>
	<body>
	    <div id="map"></div>
		<script>
		    var map = L.map('map').setView([-41, 176], 5);

			L.tileLayer('https://{s}.tiles.mapbox.com/v3/{id}/{z}/{x}/{y}.png', {
						maxZoom: 18,
						attribution: 'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, ' +
							'<a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, ' +
							'Imagery Â© <a href="http://mapbox.com">Mapbox</a>',
						id: 'leighghunt.map-pnofpde7'
					}).addTo(map);

					function onEachFeature(feature, layer) {
						var popupContent = "<p>I started out as a GeoJSON " +
								feature.geometry.type + ", but now I'm a Leaflet vector!</p>";

						if (feature.properties && feature.properties.popupContent) {
							popupContent += feature.properties.popupContent;
						}

						layer.bindPopup(popupContent);
					}

			function onLocationFound(e) {
			    var radius = e.accuracy / 2;

			    L.marker(e.latlng).addTo(map)
			        .bindPopup("You are within " + radius + " meters from this point").openPopup();

			    L.circle(e.latlng, radius).addTo(map);
			}

			map.on('locationfound', onLocationFound);

			function onLocationError(e) {
			    alert(e.message);
			}

			map.on('locationerror', onLocationError);

			map.locate({setView: true, maxZoom: 16});

	        $.getJSON("http://rawgit.com/leighghunt/1f67139a4876156f6698/raw", function(data){
			      var geojson = L.geoJson(data, {
			      onEachFeature: function (feature, layer) {
			        layer.bindPopup(feature.properties.popupContent);
			      }
			    });
			    geojson.addTo(map);
	          }
			);
	    </script>
	</body>
</html>